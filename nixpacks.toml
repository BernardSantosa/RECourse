# nixpacks.toml

providers = ["python", "node"]

[variables]
NIXPACKS_NODE_VERSION = "20"

[phases.setup]
# Memastikan pip dan gcc terinstal secara eksplisit di awal
nixPkgs = ["python3", "python3Packages.pip", "gcc"]

[phases.build]
cmds = [
    "npm --prefix client install",
    "npm --prefix client run build",
    # Setelah setup di atas, perintah ini SEHARUSNYA sudah bisa jalan
    "pip3 install -r server/requirements.txt"
]

[start]
cmd = "gunicorn --chdir server app:app"